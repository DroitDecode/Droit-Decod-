<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Droit DÃ©codÃ© - Ã€ Propos</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">

    <style>
        :root {
            --color-primary-red: #E84D3D;
            --color-primary-blue: #3E4B7A;
            --color-secondary-bg: #F8F9FA;
        }
        body { 
            background-color: var(--color-secondary-bg); 
            min-height: 100vh; 
            display: flex; 
            flex-direction: column; 
            font-family: 'Inter', sans-serif; 
        }
        main { flex-grow: 1; }
        .text-primary-red { color: var(--color-primary-red); }
        .text-primary-blue { color: var(--color-primary-blue); }
        .bg-primary-red { background-color: var(--color-primary-red); }
        .bg-primary-blue { background-color: var(--color-primary-blue); }

        /* Editable highlight */
        .editable-content:focus { 
            outline: 2px solid var(--color-primary-red); 
            background-color: #fff9f9; 
            padding: 4px;
            border-radius: 4px;
        }

        /* Mobile Menu Transitions */
        #mobile-menu {
            transition: all 0.3s ease-in-out;
        }
    </style>
</head>
<body>

    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 h-16 flex justify-between items-center">
            <a href="index.html" class="flex items-center space-x-2">
                <img src="logo1.jpeg" alt="Logo" class="h-10 w-10 rounded-full border border-gray-100">
                <div class="text-xl font-black">
                    <span class="text-primary-blue">DROIT</span> <span class="text-primary-red">DÃ‰CODÃ‰</span>
                </div>
            </a>

            <nav class="hidden md:flex items-center space-x-6 font-bold text-gray-600">
                <a href="index.html" class="hover:text-primary-red">Accueil</a>
                <a href="articles.html" class="hover:text-primary-red">Articles</a>
                <a href="about.html" class="text-primary-red">Ã€ Propos</a>
                <div id="admin-zone-desktop" class="hidden"></div>
                <a href="contact.html" class="bg-primary-red text-white px-4 py-2 rounded-lg">Contact</a>
            </nav>

            <button id="menu-btn" class="md:hidden text-primary-blue text-3xl focus:outline-none">
                &#9776;
            </button>
        </div>

        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-gray-100 p-4 space-y-4 font-bold text-gray-700 shadow-xl">
            <a href="index.html" class="block hover:text-primary-red">Accueil</a>
            <a href="articles.html" class="block hover:text-primary-red">Articles</a>
            <a href="about.html" class="block text-primary-red">Ã€ Propos</a>
            <div id="admin-zone-mobile" class="hidden border-t pt-2"></div>
            <a href="contact.html" class="block bg-primary-red text-white text-center py-2 rounded-lg">Contact</a>
        </div>
    </header>

    <main class="max-w-4xl mx-auto px-4 py-10">
        <h1 id="main-title" class="text-3xl md:text-5xl font-black text-center text-primary-blue border-b-4 border-primary-red pb-4 mb-8 editable-content">
            Chargement du titre...
        </h1>

        <section class="bg-white p-6 md:p-10 rounded-2xl shadow-xl mb-10">
            <h2 class="text-2xl font-bold text-primary-red mb-4 uppercase tracking-widest">Notre Mission</h2>
            <div id="mission-text" class="text-lg md:text-xl leading-relaxed text-gray-700 italic border-l-4 border-primary-blue pl-4 md:pl-6 mb-10 editable-content">
                Chargement de la mission...
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center mb-10">
                <div class="p-4 bg-primary-red text-white rounded-xl shadow-md">
                    <span class="text-2xl block mb-1">ðŸŽ“</span>
                    <span class="font-bold">Ã‰tudiants</span>
                </div>
                <div class="p-4 bg-primary-blue text-white rounded-xl shadow-md">
                    <span class="text-2xl block mb-1">ðŸ’¼</span>
                    <span class="font-bold">Professionnels</span>
                </div>
                <div class="p-4 bg-primary-red text-white rounded-xl shadow-md">
                    <span class="text-2xl block mb-1">ðŸ’¡</span>
                    <span class="font-bold">Citoyens</span>
                </div>
            </div>

            <div class="p-6 md:p-8 bg-primary-blue text-white rounded-2xl shadow-2xl">
                <h3 class="text-xl md:text-2xl font-bold mb-4">Notre Engagement de Rigueur</h3>
                <div id="engagement-text" class="text-base md:text-lg opacity-90 leading-relaxed editable-content">
                    Chargement de l'engagement...
                </div>
            </div>
        </section>
    </main>

    <footer class="p-8 text-center text-gray-400 text-sm border-t bg-white">
        <p>&copy; 2025 Droit DÃ©codÃ©. Tous droits rÃ©servÃ©s.</p>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, onSnapshot, setDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDpNtHXiZK3bIyLwAUlTNAiWRrg2vhPYeE",
            authDomain: "droitdecode-9aa4d.firebaseapp.com",
            projectId: "droitdecode-9aa4d",
            storageBucket: "droitdecode-9aa4d.firebasestorage.app",
            messagingSenderId: "219930978240",
            appId: "1:219930978240:web:886c40e47d276c75548a25"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const ADMIN_UID = "v4086Cxmi9PMI31GUBZzY8rHyIA3";
        const DOC_REF = doc(db, "Pages", "About");

        // UI Elements
        const menuBtn = document.getElementById('menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        const fields = {
            title: document.getElementById('main-title'),
            mission: document.getElementById('mission-text'),
            engagement: document.getElementById('engagement-text')
        };
        const adminZoneDesktop = document.getElementById('admin-zone-desktop');
        const adminZoneMobile = document.getElementById('admin-zone-mobile');

        let isEditing = false;

        // --- 1. MOBILE MENU LOGIC ---
        menuBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        // --- 2. FIREBASE REAL-TIME DATA ---
        onSnapshot(DOC_REF, (snap) => {
            if (snap.exists() && !isEditing) {
                const data = snap.data();
                fields.title.innerText = data.title || "Droit DÃ©codÃ©";
                fields.mission.innerText = data.mission || "Mission Ã  dÃ©finir...";
                fields.engagement.innerText = data.engagement || "Engagement Ã  dÃ©finir...";
            }
        });

        // --- 3. ADMIN CHECK ---
        onAuthStateChanged(auth, (user) => {
            if (user && user.uid === ADMIN_UID) {
                adminZoneDesktop.classList.remove('hidden');
                adminZoneMobile.classList.remove('hidden');
                renderAdminBtn();
            }
        });

        function renderAdminBtn() {
            [adminZoneDesktop, adminZoneMobile].forEach(zone => {
                zone.innerHTML = '';
                const btn = document.createElement('button');
                btn.className = isEditing ? "bg-green-500 text-white px-3 py-1 rounded font-bold" : "border border-blue-800 text-blue-800 px-3 py-1 rounded font-bold";
                btn.innerText = isEditing ? "âœ… SAUVEGARDER" : "âœï¸ MODIFIER";
                btn.onclick = isEditing ? saveChanges : startEditing;
                zone.appendChild(btn);
            });
        }

        function startEditing() {
            isEditing = true;
            Object.values(fields).forEach(el => el.contentEditable = true);
            renderAdminBtn();
        }

        async function saveChanges() {
            try {
                await setDoc(DOC_REF, {
                    title: fields.title.innerText,
                    mission: fields.mission.innerText,
                    engagement: fields.engagement.innerText
                }, { merge: true });
                isEditing = false;
                Object.values(fields).forEach(el => el.contentEditable = false);
                renderAdminBtn();
                alert("DonnÃ©es mises Ã  jour avec succÃ¨s !");
            } catch (e) {
                alert("Erreur: " + e.message);
            }
        }
    </script>
</body>
</html>
